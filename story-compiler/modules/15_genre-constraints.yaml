# ============================================================
# Module: Genre Constraints (ジャンル制約)
# Source: Robert McKee "Story" — ジャンルの約束事
# Version: 0.1
# ============================================================
# ジャンルは「約束事（conventions）」である。
# 読者/観客はジャンルに基づいて期待を持つ。
# その期待を裏切る（違反する）ことはエラーだが、
# 期待を超えることが優れた物語になる。
# ジャンル制約は差し替え可能。
# ============================================================

module_id: genre_constraints
module_name: "ジャンル制約（Genre Constraints）"
source: "McKee 'Story'"

# ============================================================
# ジャンルの定義
# ============================================================
genre_definition:
  description: >
    ジャンルは読者への約束事のセット。
    設定、役割、出来事、価値要素の4つの構成要素から成る。

  components:
    setting:
      description: "ジャンルが期待する舞台・環境設定"
      examples:
        mystery: "閉鎖空間、秘密のある場所"
        romance: "出会いの場、隔離された環境"
        horror: "不気味な場所、逃げられない空間"
        sf: "未来の技術、宇宙、異世界"

    roles:
      description: "ジャンルが期待する登場人物の役割"
      examples:
        mystery: "探偵、容疑者、被害者、証人"
        romance: "恋人候補、ライバル、親友/相談役"
        horror: "脅威の源、犠牲者、生存者"
        thriller: "主人公、敵対者、内通者"

    events:
      description: "ジャンルが期待する出来事パターン"
      examples:
        mystery: "事件発生、手がかり発見、推理、真相解明"
        romance: "出会い、障害、別離、再会/成就"
        horror: "異常の兆候、遭遇、追跡、対決"
        coming_of_age: "旧世界、試練、覚醒、帰還"

    value_elements:
      description: "ジャンルの中心的な価値軸"
      examples:
        mystery: "真実 vs 隠蔽"
        romance: "愛 vs 孤独"
        horror: "安全 vs 恐怖"
        thriller: "生 vs 死"
        literary: "人間性の本質（多軸）"

# ============================================================
# 制約ルール
# ============================================================
enforcement:
  genre_declared:
    required: true
    description: "global_settingsでジャンルが宣言されていること"
    severity: compile_error
    message: "ジャンルが未宣言です。global_settingsで定義してください"

  genre_convention_violation:
    severity: compile_error
    description: >
      宣言されたジャンルの核心的な約束事に違反している場合。
      例: ミステリーで真相が解明されない（意図的でない場合）
    message: >
      ジャンルの約束事に違反しています。
      意図的な逸脱であればstory_triangle.typeをanti_plotに変更してください。

  genre_expectation_unmet:
    severity: warning
    description: >
      ジャンルの標準的な要素が欠けている場合。
      必ずしもエラーではないが、意図の確認が必要。
    message: >
      ジャンルの標準的な要素が不足している可能性があります。
      意図的な省略か確認してください。

# ============================================================
# 差し替え可能性
# ============================================================
swappable: true
swap_description: >
  ジャンル制約は作品ごとに差し替え可能。
  独自のジャンル定義を作成し、このモジュールと入れ替えることができる。
  ハイブリッドジャンルの場合は複数のジャンル制約を組み合わせる。

# ============================================================
# ジャンル横断の共通ルール
# ============================================================
universal_rules:
  - "ジャンルの約束事を知った上で破ること ≠ 知らずに違反すること"
  - "ジャンル混合は許可されるが、主ジャンルは1つ宣言必須"
  - "ジャンルの約束事を超える展開こそが優れた物語"
