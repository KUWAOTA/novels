# ============================================================
# Module: Tension Dynamics (緊張リズム制約)
# Source: Robert McKee "Story" — 緊張と緩和のリズム
# Version: 0.1
# ============================================================
# 物語は緊張と緩和のリズムで構成される。
# クライマックス前には緩和（休憩）が必要、
# 緩和がずっと続くと読者は眠る。
# リズムは物語後半に向けて加速する。
# ============================================================

module_id: tension_dynamics
module_name: "緊張リズム制約（Tension Dynamics）"
source: "McKee 'Story'"

# ============================================================
# 緊張/緩和の宣言
# ============================================================
tension_release_requirement:
  applies_to:
    - Story
    - Act
    - Sequence
    - Scene
    - Beat

  required_arguments:
    - tension_level     # 数値 (1-5) or low/medium/high
    - release_level     # 数値 or low/medium/high

  description: >
    全ての物語単位は緊張と緩和のレベルを明示的に宣言する。
    緊張/緩和は構造的リズムであり、オプションの効果ではない。

# ============================================================
# リズム加速ルール
# ============================================================
rhythm_acceleration_rule:
  purpose: >
    緊張と緩和の交替リズムが、
    物語後半（結末に向けて）加速することを保証する。

  evaluation_model:
    rhythm_metrics:
      - alternation_frequency        # 緊張/緩和の切り替え頻度
      - unit_length_between_peaks    # 高緊張ポイント間の物語的距離

  progression_constraint:
    expected_trend: accelerating
    description: >
      物語後半では緊張–緩和サイクルがより頻繁に（短い間隔、速い切り替えで）
      前半よりも発生すべき。

  compile_time_checks:

    insufficient_acceleration_detected:
      description: >
        緊張–緩和リズムが物語後半で加速していない場合、
        物語の推進力が平坦または停滞に感じられる可能性。
      action: warning
      message: >
        後半セクションで緊張/緩和のリズムが加速していません。
        クライマックスに向けてサイクルを短くするか、
        交替頻度を増やすことを検討してください。

# ============================================================
# クライマックス前の緩和チェック
# ============================================================
pre_climax_release:
  purpose: >
    クライマックスや高緊張シーンの直前に
    緩和（休憩）を挟んでいるか確認する。
    読者が集中できる状態を作るため。

  compile_time_checks:

    no_release_before_climax:
      description: >
        クライマックス直前に緩和ビートがない場合、
        読者の集中力が確保されていない可能性。
      action: warning
      message: >
        クライマックス前に緩和（休憩）ビートがありません。
        読者が緊張を受け止める準備ができているか確認してください。

# ============================================================
# 緩和の過剰持続チェック
# ============================================================
extended_release_detection:
  purpose: >
    緩和がずっと続いて読者が眠くなっていないか検出する。

  compile_time_checks:

    excessive_release_duration:
      description: >
        緩和が長時間持続すると物語の推進力が失われる。
      action: warning
      message: >
        緩和が長時間続いています。
        読者の注意が失われるリスクがあります。
        緊張要素を挿入することを検討してください。

    monotone_tension:
      description: >
        緊張が一定レベルで変化しない場合、
        リズムが単調になっている。
      action: warning
      message: >
        緊張レベルが変化していません。
        リズムの緩急をつけてください。

# ============================================================
# 意図的リズム設計
# ============================================================
intentional_rhythm_checks:
  description: >
    意図的なリズム設計が行われているか確認する。
    「ここで読者を緊張させたい」「ここで息をつかせたい」
    という意図が構造に反映されているか。

  compile_time_checks:

    rhythm_intent_missing:
      description: "リズムの意図が宣言されていない単位"
      action: info
      message: >
        このセクションのリズム意図が未宣言です。
        緊張/緩和の狙いを明示すると構造的一貫性が高まります。
